(function(a){a.fn.circleMagic=function(r){var f,o,h,p,d=true;var m=[];var i=a.extend({color:"rgba(255,255,255,.5)",radius:10,density:0.3,clearOffset:0.2},r);var c=this["0"];j();n();function j(){f=c.offsetWidth;o=c.offsetHeight;q();h=document.getElementById("homeTopCanvas");h.width=f;h.height=o;h.style.position="absolute";h.style.left="0";h.style.bottom="0";p=h.getContext("2d");for(var s=0;s<f*i.density;s++){var t=new b();m.push(t)}e()}function q(){var s=document.createElement("canvas");s.id="homeTopCanvas";c.appendChild(s);s.parentElement.style.overflow="hidden"}function n(){window.addEventListener("scroll",l,false);window.addEventListener("resize",g,false)}function l(){if(document.body.scrollTop>o){d=false}else{d=true}}function g(){f=c.clientWidth;o=c.clientHeight;c.height=o+"px";h.width=f;h.height=o}function e(){if(d){p.clearRect(0,0,f,o);for(var s in m){m[s].draw()}}requestAnimationFrame(e)}function k(){var u=Math.floor(Math.random()*255);var t=Math.floor(Math.random()*255);var s=Math.floor(Math.random()*255);var v=Math.random().toPrecision(2);return"rgba("+u+", "+t+", "+s+", "+v+")"}function b(){var s=this;(function(){s.pos={};t()})();function t(){s.pos.x=Math.random()*f;s.pos.y=o+Math.random()*100;s.alpha=0.1+Math.random()*i.clearOffset;s.scale=0.1+Math.random()*0.3;s.speed=Math.random();if(i.color==="random"){s.color=k()}else{s.color=i.color}}this.draw=function(){if(s.alpha<=0){t()}s.pos.y-=s.speed;s.alpha-=0.0005;p.beginPath();p.arc(s.pos.x,s.pos.y,s.scale*i.radius,0,2*Math.PI,false);p.fillStyle=s.color;p.fill();p.closePath()}}}})(jQuery);